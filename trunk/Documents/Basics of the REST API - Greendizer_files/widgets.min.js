(function(){window.greendizer=window.greendizer||{};var a=window.greendizer;a.widgets=a.widgets||{};a.utils=a.domUtils||{};(function(){if(!Array.prototype.indexOf)Array.prototype.indexOf=function(d,a){for(var b=a||0;b<this.length;b++)if(this[b]===d)return b;return-1}})();a.utils.addEvent=function(a,c,b){window.addEventListener?a.addEventListener(c,b):a.attachEvent("on"+c,b)};a.utils.dispatchEvent=function(a,c){var b=document.createEvent("Event");b.initEvent(c,!0,!0);return a.dispatchEvent(b)};a.utils.hasClass=
function(a,c){return a.className.match(RegExp("(\\s|^)"+c+"(\\s|$)"))};a.utils.addClass=function(d,c){a.utils.hasClass(d,c)||(d.className+=" "+c)};a.utils.removeClass=function(d,c){if(a.utils.hasClass(d,c))d.className=d.className.replace(RegExp("(\\s|^)"+c+"(\\s|$)")," ")};a.utils.extractDomain=function(a){if((a=/^(http[s]?:\/\/[^/]+)\/?.*$/.exec(a))&&1<a.length)return a[1]};a.utils.endsWith=function(a,c){return a.substr(Math.max(a.length-c.length,0))===c};a.utils.isValidEmail=function(a){return/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i.test(a)};
a.utils.isValidBoolean=function(a){return/^(true|false|0|1)$/i.test(a)};(function(){function d(){e=!0;a.widgets.widgetManager.getInstance()}function c(){if(!e){try{document.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}d()}}var b,e=!1;document.addEventListener?b=function(){document.removeEventListener("DOMContentLoaded",b,!1);d()}:document.attachEvent&&(b=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",b),d())});if("complete"===document.readyState)return setTimeout(d,
10);if(document.addEventListener)document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",d,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",b);window.attachEvent("onload",d);var j=!1;try{j=null==window.frameElement}catch(g){}document.documentElement.doScroll&&j&&c()}})();a.environment={LIST_URL:"https://list.greendizer.com/",CENTRAL_URL:"https://central.greendizer.com/"};a.widgets.Central=function(d){var c=this,b=!1,e;a.widgets.WidgetBase.call(this,
d);var j=this.init,g=this.processMessage;this.init=function(){var b=document.createElement("iframe"),e={display:"none",position:"fixed",width:"100%",height:"100%",zIndex:"9999",top:"0",left:"0",backgroundColor:"transparent"};for(s in e)b.style[s]=e[s];j.call(this,b,a.widgets.Central.REQUIRED,a.widgets.Central.DEFAULTS)};this.show=function(){e=document.body.style.overflow;document.body.style.overflow="hidden";this.getElement().style.display="block";a.utils.removeClass(this.getElement(),"invisible");
a.utils.addClass(this.getElement(),"visible");a.utils.dispatchEvent(window,"gdCentralVisible")};this.hide=function(){document.body.style.overflow=e||"auto";a.utils.removeClass(this.getElement(),"visible");a.utils.addClass(this.getElement(),"invisible");this.getElement().style.display="none";a.utils.dispatchEvent(window,"gdCentralInvisible")};this.isReady=function(){return b};this.getName=function(){return"Central"};this.getURL=function(){return a.environment.CENTRAL_URL};this.validate=function(a){a.lang=
a.lang||document.getElementsByTagName("html")[0].getAttribute("lang")||window.navigator.language||window.navigator.userLanguage;return a};this.processMessage=function(e){if(g.call(this,e))switch(e=e.data,e.type){case "state":switch(e.state){case "authenticated":b=!0;a.utils.dispatchEvent(window,"gdCentralReady");break;case "sleep":c.hide()}break;case "navigation":window.location.href=e.url}}};a.widgets.Central.REQUIRED=[];a.widgets.Central.DEFAULTS={lang:"en-US"};a.widgets.InvoiceList=function(d){a.widgets.WidgetBase.call(this,
d);var c=this.init,b=this.processMessage;this.init=function(){c.call(this,document.createElement("iframe"),a.widgets.InvoiceList.REQUIRED,a.widgets.InvoiceList.DEFAULTS)};this.getName=function(){return"InvoiceList"};this.getURL=function(){return a.environment.LIST_URL};this.validate=function(b){if(!b.token&&0===b.token.length)throw Error("Invalid OAuth token");if(!a.utils.isValidEmail(b.seller))throw Error("Invalid 'seller' email address.");if(!a.utils.isValidEmail(b.buyer))throw Error("Invalid 'buyer' email address.");
if(b.autosize&&!a.utils.isValidBoolean(b.autosize))throw Error("Invalid 'autosize' value.");b.lang=b.lang||document.getElementsByTagName("html")[0].getAttribute("lang")||window.navigator.language||window.navigator.userLanguage;return b};this.processMessage=function(a){if(b.call(this,a))switch(a=a.data,a.type){case "resize":this.getElement().style.display="block",this.getElement().style.height=a.height+"px"}}};a.widgets.InvoiceList.REQUIRED=["token","seller","buyer"];a.widgets.InvoiceList.DEFAULTS=
{token:null,buyer:null,seller:null,lang:"en-US",autosize:"true"};a.widgets.WidgetBase=function(a){var c,b,e={},j;this.init=function(g,c,k){b=g||document.createElement("iframe");try{var f,g=k;f=c||[];for(var g=g||{},h=a.attributes,c=0;c<h.length;c++){var l=h[c].name,n=h[c].value;if(l in g){if(!n&&-1!==f.indexOf(l))throw Error(l);e[l]=n||g[l]}else b.setAttribute(l,n)}for(h=0;h<f.length;h++)if(!e[f[h]])throw Error(f[h]);}catch(o){console.error(this.getName()+": '"+o.message+"' attribute is required.");
return}try{e=this.validate(e)||e}catch(p){console.error(p.message);return}f=[];for(var i in e)f.push(i+"="+escape(e[i]));f.push("origin="+escape(window.location.protocol+"//"+window.location.host));f.push("id="+this.getID());b.frameBorder="0";b.name=f.join("&");b.setAttribute("data-gd-id",this.getID());b.src=this.getURL();i=this.getURL();j="/"===i.charAt(i.length-1)?i.substr(0,i.length-1):i;b&&a&&a.parentNode.replaceChild(b,a)};this.getParameter=function(a){return e[a]};this.getElement=function(){return b};
this.getName=function(){return"Widget"};this.getID=function(){return c=c||(new Date).getTime().toString()+Math.random().toString()};this.processMessage=function(a){return a.origin===j&&!b.removeAttribute("name")}};a.widgets.widgetManager=function(){var d,c=function(){var b={},c={"greendizer:list":a.widgets.InvoiceList,"greendizer:central":a.widgets.Central},d=function(c){if(a.utils.endsWith(a.utils.extractDomain(c.origin),"greendizer.com")){var c={data:JSON.parse(c.data||""),origin:c.origin,source:c.source},
d;for(d in b)for(id in b[d])b[d][id].processMessage(c)}};this.getWidget=function(a){a=a.getAttribute("data-gd-id");for(tag in b)if(b[tag][a])return b[tag][a]};(function(){a.utils.addEvent(window,"message",d);for(tag in c)for(var g=document.body.getElementsByTagName(tag),m=0;m<g.length;m++){var k=new c[tag](g[m]);b[k.getName()]=b[k.getName()]||{};b[k.getName()][k.getID()]=k}for(var f in b)for(id in b[f])b[f][id].init()})()};return new function(){this.getInstance=function(){if(!d)d=new c,d.constructor=
null;return d}}}()})();
